<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Month Countdown Widget</title>

<style>
  :root {
    --bg: #ECEAF3;
    --text: #7B61C9;
    --progress: #7B61C9;
    --radius: 18px;
    --fontScale: 1;
  }

  body {
    margin: 0;
    background: transparent;
    font-family: Inter, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  }

  .widget {
    background: var(--bg);
    border-radius: var(--radius);
    padding: 18px;
    width: 100%;
    box-sizing: border-box;
    transform: scale(var(--fontScale));
    transform-origin: top left;
  }

  .grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }

  .block {
    background: rgba(255,255,255,0.35);
    border-radius: calc(var(--radius) - 4px);
    padding: 18px;
    text-align: center;
  }

  .big-number {
    font-size: 96px;
    font-weight: 700;
    color: var(--text);
    line-height: 1;
  }

  .label {
    margin-top: 6px;
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 0.08em;
    color: var(--text);
    text-transform: uppercase;
  }

  .weekday,.month {
    margin-top: 10px;
    font-size: 16px;
    font-weight: 700;
    letter-spacing: 0.1em;
    color: var(--text);
    text-transform: uppercase;
  }

  .progress-wrap {
    margin-top: 16px;
    height: 10px;
    background: rgba(0,0,0,0.08);
    border-radius: 999px;
    overflow: hidden;
  }

  .progress-bar {
    height: 100%;
    width: 0%;
    background: var(--progress);
    transition: width 0.4s ease;
  }
</style>
</head>

<body>

<div class="widget">
  <div class="grid">
    <!-- DAY -->
    <div class="block">
      <div class="month" id="month">---</div>
      <div class="big-number" id="dayNumber">--</div>
      <div class="weekday" id="weekday">---</div>
    </div>

    <!-- DAYS LEFT -->
    <div class="block">
      <div class="big-number" id="daysLeft">--</div>
      <div class="label">Days Left</div>
      <div class="progress-wrap">
        <div class="progress-bar" id="progressBar"></div>
      </div>
    </div>
  </div>
</div>

<script>
/* =========================
   QUERY STRING PARAMETERS
========================= */
const params = new URLSearchParams(window.location.search);

const bg = params.get("bg");
const text = params.get("text");
const progress = params.get("progress");
const radius = params.get("radius");
const fontScale = params.get("fontScale");

/* =========================
   APPLY CUSTOMIZATION
========================= */
if (bg) document.documentElement.style.setProperty("--bg", bg);
if (text) document.documentElement.style.setProperty("--text", text);
if (progress) document.documentElement.style.setProperty("--progress", progress);
if (radius) document.documentElement.style.setProperty("--radius", `${radius}px`);
if (fontScale) document.documentElement.style.setProperty("--fontScale", fontScale);

/* =========================
   DATE LOGIC
========================= */
function updateWidget() {
  const now = new Date();

  document.getElementById("dayNumber").innerText = now.getDate();
  document.getElementById("weekday").innerText =
    now.toLocaleDateString(undefined, { weekday: "long" });
  document.getElementById("month").innerText =
    now.toLocaleDateString(undefined, { month: "long" });

  const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0);
  const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);

  const msPerDay = 1000 * 60 * 60 * 24;
  const daysLeft = Math.ceil((endOfMonth - now) / msPerDay);
  const totalDays = Math.ceil((endOfMonth - startOfMonth) / msPerDay);

  document.getElementById("daysLeft").innerText = daysLeft;

  const progressPercent = ((totalDays - daysLeft) / totalDays) * 100;
  document.getElementById("progressBar").style.width = `${progressPercent}%`;
}

updateWidget();
setInterval(updateWidget, 60 * 60 * 1000);
</script>

</body>
</html>
